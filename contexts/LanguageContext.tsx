import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import { Language } from '../types';

type Translations = Record<string, string>;
type Dictionary = Record<Language, Translations>;

const dictionary: Dictionary = {
  'en': {
    'app.name': 'NostrLink',
    'app.desc': 'Secure, decentralized messaging.',
    'login.title': 'Login',
    'login.generate': 'Generate New Key',
    'login.or': 'Or',
    'login.placeholder': 'nsec1...',
    'login.error.format': 'Invalid key format. Must start with nsec.',
    'login.error.invalid': 'Invalid Private Key',
    'login.success': 'New Key Generated!',
    'login.warning': 'Save this key safely! If you lose it, your account is gone forever.',
    'nav.global': 'Global Chat',
    'nav.community': 'Community',
    'nav.group': 'Group Chat',
    'nav.dm': 'Direct Messages',
    'nav.settings': 'Settings',
    'nav.logout': 'Logout',
    'settings.title': 'Settings',
    'settings.language': 'Language',
    'settings.relays': 'Relay Settings',
    'settings.add_relay': 'Add New Relay',
    'settings.connected': 'Connected Relays',
    'settings.health': 'Relay Health',
    'settings.health_desc': 'Lower latency (ms) means faster message delivery. We recommend keeping at least 2 green relays.',
    'settings.address': 'Your Address',
    'settings.copy': 'Copy',
    'settings.private_key': 'Private Key',
    'settings.private_key_warning': 'Store this private key safely. Anyone with it can control your account.',
    'settings.relay_invalid': 'Invalid relay URL.',
    'chat.placeholder': 'Broadcast to the world...',
    'chat.placeholder_dm': 'Send encrypted message...',
    'chat.connecting': 'Connecting to relays...',
    'chat.no_messages': 'No messages found.',
    'chat.be_first': 'Be the first to say hello!',
    'chat.send_failed': 'Failed to send. Check relay connection.',
    'chat.upload_failed': 'Upload failed. Check R2 settings.',
    'chat.record_failed': 'Recording failed. Check microphone permissions.',
    'chat.add_image': 'Add Image',
    'chat.add_video': 'Add Video',
    'chat.add_audio': 'Add Audio',
    'chat.record_voice': 'Record Voice',
    'chat.stop_recording': 'Stop Recording',
    'chat.recording': 'Recording...',
    'chat.remove_attachment': 'Remove attachment',
    'chat.add_file': 'Add File',
    'chat.choose_file': 'Choose File',
    'chat.choose_audio': 'Choose Audio File',
    'chat.take_photo': 'Take Photo',
    'chat.take_video': 'Record Video',
    'chat.cancel': 'Cancel',
    'chat.preview_image': '[Image]',
    'chat.preview_video': '[Video]',
    'chat.preview_audio': '[Audio]',
    'chat.preview_file': '[File]',
    'dm.search': 'Start new chat (npub...)',
    'dm.no_convos': 'No conversations found.',
    'dm.start_prompt': 'Start a chat with a public key above.',
    'community.title': 'Community',
    'community.live': 'Live from',
    'community.listening': 'Listening for events...',
    'community.no_posts': 'No posts found on connected relays.',
    'community.post': 'Post',
    'community.posting': 'Posting...',
    'community.cancel': 'Cancel',
    'community.whats_happening': "What's happening?",
    'community.failed': 'Failed to post message.',
    'community.profile': 'Profile',
    'community.my_posts': 'My posts',
    'community.back': 'Back',
    'group.tab_public': 'Public',
    'group.tab_joined': 'Joined',
    'group.no_joined': 'No joined groups yet.',
    'group.channel_id': 'Channel ID:',
    'group.members': 'Members:',
    'group.info': 'Group Info',
    'group.close': 'Close',
    'group.name': 'Name',
    'group.about': 'About',
    'group.share': 'Share',
    'group.link_copied': 'Link copied',
    'group.members_recent': 'Recent active members:',
    'group.subtitle': 'Channels and group chats',
    'group.create': 'Create Group',
    'group.join': 'Join Group',
    'group.name_placeholder': 'Group name',
    'group.about_placeholder': 'About (optional)',
    'group.join_placeholder': 'Paste channel id...',
    'group.invalid_channel': 'Invalid channel id.',
    'group.create_failed': 'Failed to create group.',
    'group.no_channels': 'No groups found on connected relays.',
    'group.unknown_time': 'unknown',
    'group.unnamed': 'Untitled Group',
    'group.back': 'Back',
    'group.loading': 'Loading channel...',
    'group.no_messages': 'No messages found.',
    'group.be_first': 'Be the first to say hello!',
    'group.placeholder': 'Send a message to the group...',
    'group.send_failed': 'Failed to send. Check relay connection.',
  },
  'zh-CN': {
    'app.name': 'NostrLink',
    'app.desc': '安全、去中心化的消息传递。',
    'login.title': '登录',
    'login.generate': '生成新密钥',
    'login.or': '或',
    'login.placeholder': 'nsec1...',
    'login.error.format': '密钥格式无效，必须以 nsec 开头。',
    'login.error.invalid': '无效的私钥',
    'login.success': '新密钥已生成！',
    'login.warning': '请妥善保存此私钥！一旦丢失将无法找回。',
    'nav.global': '全球聊天',
    'nav.community': '社区',
    'nav.group': '群聊',
    'nav.dm': '私信',
    'nav.settings': '设置',
    'nav.logout': '退出登录',
    'settings.title': '设置',
    'settings.language': '语言',
    'settings.relays': '中继设置',
    'settings.add_relay': '添加新中继',
    'settings.connected': '已连接的中继',
    'settings.health': '中继健康',
    'settings.health_desc': '延迟(ms)越低，消息传递越快。建议至少保留 2 个健康中继。',
    'settings.address': '我的地址',
    'settings.copy': '复制',
    'settings.private_key': '私钥',
    'settings.private_key_warning': '请妥善保管私钥，任何人持有它都可控制你的账户。',
    'settings.relay_invalid': '中继地址无效。',
    'chat.placeholder': '向世界广播...',
    'chat.placeholder_dm': '发送加密消息...',
    'chat.connecting': '正在连接中继...',
    'chat.no_messages': '未找到消息。',
    'chat.be_first': '成为第一个打招呼的人！',
    'chat.send_failed': '发送失败，请检查中继连接。',
    'chat.upload_failed': '\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u0020R2\u0020\u914d\u7f6e\u3002',
    'chat.record_failed': '\u5f55\u97f3\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u9ea6\u514b\u98ce\u6743\u9650\u3002',
    'chat.add_image': '\u6dfb\u52a0\u56fe\u7247',
    'chat.add_video': '\u6dfb\u52a0\u89c6\u9891',
    'chat.add_audio': '\u6dfb\u52a0\u97f3\u9891',
    'chat.record_voice': '\u5f55\u5236\u8bed\u97f3',
    'chat.stop_recording': '\u505c\u6b62\u5f55\u5236',
    'chat.recording': '\u6b63\u5728\u5f55\u5236...',
    'chat.remove_attachment': '\u79fb\u9664\u9644\u4ef6',
    'chat.add_file': '\u6dfb\u52a0\u6587\u4ef6',
    'chat.choose_file': '\u9009\u62e9\u6587\u4ef6',
    'chat.choose_audio': '\u9009\u62e9\u97f3\u9891\u6587\u4ef6',
    'chat.take_photo': '\u62cd\u7167',
    'chat.take_video': '\u62cd\u6444\u89c6\u9891',
    'chat.cancel': '\u53d6\u6d88',
    'chat.preview_image': '[\u56fe\u7247]',
    'chat.preview_video': '[\u89c6\u9891]',
    'chat.preview_audio': '[\u97f3\u9891]',
    'chat.preview_file': '[\u6587\u4ef6]',
    'dm.search': '开始新聊天 (npub...)',
    'dm.no_convos': '未找到对话。',
    'dm.start_prompt': '使用上方的公钥开始聊天。',
    'community.title': '社区',
    'community.live': '实时来自',
    'community.listening': '正在监听事件...',
    'community.no_posts': '在已连接的中继中未找到帖子。',
    'community.post': '发布',
    'community.posting': '正在发布...',
    'community.cancel': '取消',
    'community.whats_happening': '发生了什么？',
    'community.failed': '发布失败。',
    'community.profile': '个人主页',
    'community.my_posts': '我的帖子',
    'community.back': '返回',
    'group.tab_public': '\u516c\u5f00\u7fa4\u804a',
    'group.tab_joined': '\u6211\u52a0\u5165\u7684\u7fa4\u804a',
    'group.no_joined': '\u8fd8\u6ca1\u6709\u52a0\u5165\u4efb\u4f55\u7fa4\u804a\u3002',
    'group.channel_id': '\u7fa4\u804aID\uff1a',
    'group.members': '\u6210\u5458\u6570\uff1a',
    'group.info': '\u7fa4\u804a\u4fe1\u606f',
    'group.close': '\u5173\u95ed',
    'group.name': '\u540d\u79f0',
    'group.about': '\u7b80\u4ecb',
    'group.share': '\u5206\u4eab',
    'group.link_copied': '\u94fe\u63a5\u5df2\u590d\u5236',
    'group.members_recent': '\u6700\u8fd1\u6d3b\u8dc3\u6210\u5458\uff1a',
    'group.subtitle': '群组与频道聊天',
    'group.create': '创建群聊',
    'group.join': '加入群聊',
    'group.name_placeholder': '群聊名称',
    'group.about_placeholder': '群聊简介（可选）',
    'group.join_placeholder': '粘贴群聊ID...',
    'group.invalid_channel': '群聊ID无效。',
    'group.create_failed': '创建群聊失败。',
    'group.no_channels': '在已连接的中继中未找到群聊。',
    'group.unknown_time': '未知',
    'group.unnamed': '未命名群聊',
    'group.back': '返回',
    'group.loading': '正在加载群聊...',
    'group.no_messages': '暂无消息。',
    'group.be_first': '成为第一个发言的人！',
    'group.placeholder': '发送群聊消息...',
    'group.send_failed': '发送失败，请检查中继连接。',
  },
  'zh-TW': {
    'app.name': 'NostrLink',
    'app.desc': '安全、去中心化的訊息傳遞。',
    'login.title': '登入',
    'login.generate': '產生新金鑰',
    'login.or': '或',
    'login.placeholder': 'nsec1...',
    'login.error.format': '金鑰格式無效，必須以 nsec 開頭。',
    'login.error.invalid': '無效的私鑰',
    'login.success': '新金鑰已產生！',
    'login.warning': '請妥善保存私鑰！遺失將無法找回。',
    'nav.global': '全球聊天',
    'nav.community': '社群',
    'nav.group': '群聊',
    'nav.dm': '私訊',
    'nav.settings': '設定',
    'nav.logout': '登出',
    'settings.title': '設定',
    'settings.language': '語言',
    'settings.relays': '中繼設定',
    'settings.add_relay': '新增中繼',
    'settings.connected': '已連線的中繼',
    'settings.health': '中繼健康',
    'settings.health_desc': '延遲(ms)越低，訊息傳遞越快。建議至少保留 2 個健康中繼。',
    'settings.address': '我的地址',
    'settings.copy': '複製',
    'settings.private_key': '私鑰',
    'settings.private_key_warning': '請妥善保管私鑰，任何人持有它都可控制你的帳戶。',
    'settings.relay_invalid': '中繼地址無效。',
    'chat.placeholder': '向世界廣播...',
    'chat.placeholder_dm': '傳送加密訊息...',
    'chat.connecting': '正在連線中繼...',
    'chat.no_messages': '未找到訊息。',
    'chat.be_first': '成為第一個打招呼的人！',
    'chat.send_failed': '傳送失敗，請檢查中繼連線。',
    'chat.upload_failed': '\u4e0a\u50b3\u5931\u6557\uff0c\u8acb\u6aa2\u67e5\u0020R2\u0020\u8a2d\u5b9a\u3002',
    'chat.record_failed': '\u9304\u97f3\u5931\u6557\uff0c\u8acb\u6aa2\u67e5\u9ea5\u514b\u98a8\u6b0a\u9650\u3002',
    'chat.add_image': '\u6dfb\u52a0\u5716\u7247',
    'chat.add_video': '\u6dfb\u52a0\u5f71\u7247',
    'chat.add_audio': '\u6dfb\u52a0\u97f3\u8a0a',
    'chat.record_voice': '\u9304\u88fd\u8a9e\u97f3',
    'chat.stop_recording': '\u505c\u6b62\u9304\u88fd',
    'chat.recording': '\u6b63\u5728\u9304\u88fd...',
    'chat.remove_attachment': '\u79fb\u9664\u9644\u4ef6',
    'chat.add_file': '\u65b0\u589e\u6a94\u6848',
    'chat.choose_file': '\u9078\u64c7\u6a94\u6848',
    'chat.choose_audio': '\u9078\u64c7\u97f3\u8a0a\u6a94\u6848',
    'chat.take_photo': '\u62cd\u7167',
    'chat.take_video': '\u62cd\u651d\u5f71\u7247',
    'chat.cancel': '\u53d6\u6d88',
    'chat.preview_image': '[\u5716\u7247]',
    'chat.preview_video': '[\u5f71\u7247]',
    'chat.preview_audio': '[\u97f3\u8a0a]',
    'chat.preview_file': '[\u6a94\u6848]',
    'dm.search': '開始新聊天 (npub...)',
    'dm.no_convos': '未找到對話。',
    'dm.start_prompt': '使用上方的公鑰開始聊天。',
    'community.title': '社群',
    'community.live': '即時來自',
    'community.listening': '正在監聽事件...',
    'community.no_posts': '在已連線的中繼中未找到貼文。',
    'community.post': '發布',
    'community.posting': '正在發布...',
    'community.cancel': '取消',
    'community.whats_happening': '發生了什麼？',
    'community.failed': '發布失敗。',
    'community.profile': '個人頁面',
    'community.my_posts': '我的貼文',
    'community.back': '返回',
    'group.tab_public': '\u516c\u958b\u7fa4\u804a',
    'group.tab_joined': '\u6211\u52a0\u5165\u7684\u7fa4\u804a',
    'group.no_joined': '\u5c1a\u672a\u52a0\u5165\u4efb\u4f55\u7fa4\u804a\u3002',
    'group.channel_id': '\u7fa4\u804aID\uff1a',
    'group.members': '\u6210\u54e1\u6578\uff1a',
    'group.info': '\u7fa4\u804a\u8cc7\u8a0a',
    'group.close': '\u95dc\u9589',
    'group.name': '\u540d\u7a31',
    'group.about': '\u7c21\u4ecb',
    'group.share': '\u5206\u4eab',
    'group.link_copied': '\u9023\u7d50\u5df2\u8907\u88fd',
    'group.members_recent': '\u6700\u8fd1\u6d3b\u8e8d\u6210\u54e1\uff1a',
    'group.subtitle': '群組與頻道聊天',
    'group.create': '建立群聊',
    'group.join': '加入群聊',
    'group.name_placeholder': '群聊名稱',
    'group.about_placeholder': '群聊簡介（選填）',
    'group.join_placeholder': '貼上群聊ID...',
    'group.invalid_channel': '群聊ID無效。',
    'group.create_failed': '建立群聊失敗。',
    'group.no_channels': '在已連線的中繼中未找到群聊。',
    'group.unknown_time': '未知',
    'group.unnamed': '未命名群聊',
    'group.back': '返回',
    'group.loading': '正在載入群聊...',
    'group.no_messages': '暫無訊息。',
    'group.be_first': '成為第一個發言的人！',
    'group.placeholder': '傳送群聊訊息...',
    'group.send_failed': '傳送失敗，請檢查中繼連線。',
  },
  'ru': {
    'app.name': 'NostrLink',
    'app.desc': 'Безопасные децентрализованные сообщения.',
    'login.title': 'Вход',
    'login.generate': 'Создать новый ключ',
    'login.or': 'Или',
    'login.placeholder': 'nsec1...',
    'login.error.format': 'Неверный формат ключа. Должен начинаться с nsec.',
    'login.error.invalid': 'Недействительный приватный ключ',
    'login.success': 'Новый ключ создан!',
    'login.warning': 'Сохраните ключ! Если вы его потеряете, аккаунт будет утерян навсегда.',
    'nav.global': 'Глобальный чат',
    'nav.community': 'Сообщество',
    'nav.group': 'Групповой чат',
    'nav.dm': 'Личные сообщения',
    'nav.settings': 'Настройки',
    'nav.logout': 'Выйти',
    'settings.title': 'Настройки',
    'settings.language': 'Язык',
    'settings.relays': 'Настройки реле',
    'settings.add_relay': 'Добавить реле',
    'settings.connected': 'Подключенные реле',
    'settings.health': 'Состояние реле',
    'settings.health_desc': 'Чем ниже задержка (мс), тем быстрее доставка. Рекомендуем минимум 2 здоровых реле.',
    'settings.address': 'Мой адрес',
    'settings.copy': 'Копировать',
    'settings.private_key': 'Приватный ключ',
    'settings.private_key_warning': 'Храните приватный ключ в безопасности. Любой, у кого он есть, может управлять аккаунтом.',
    'settings.relay_invalid': 'Неверный адрес реле.',
    'chat.placeholder': 'Сообщение всему миру...',
    'chat.placeholder_dm': 'Отправить зашифрованное сообщение...',
    'chat.connecting': 'Подключение к реле...',
    'chat.no_messages': 'Сообщения не найдены.',
    'chat.be_first': 'Скажите привет первым!',
    'chat.send_failed': 'Не удалось отправить. Проверьте подключение к реле.',
    'chat.upload_failed': '\u041e\u0448\u0438\u0431\u043a\u0430\u0020\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438\u002e\u0020\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435\u0020\u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\u0020R2\u002e',
    'chat.record_failed': '\u041d\u0435\u0020\u0443\u0434\u0430\u043b\u043e\u0441\u044c\u0020\u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u002e\u0020\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435\u0020\u0434\u043e\u0441\u0442\u0443\u043f\u0020\u043a\u0020\u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d\u0443\u002e',
    'chat.add_image': '\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c\u0020\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435',
    'chat.add_video': '\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c\u0020\u0432\u0438\u0434\u0435\u043e',
    'chat.add_audio': '\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c\u0020\u0430\u0443\u0434\u0438\u043e',
    'chat.record_voice': '\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0020\u0433\u043e\u043b\u043e\u0441',
    'chat.stop_recording': '\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\u0020\u0437\u0430\u043f\u0438\u0441\u044c',
    'chat.recording': '\u0418\u0434\u0451\u0442\u0020\u0437\u0430\u043f\u0438\u0441\u044c...',
    'chat.remove_attachment': '\u0423\u0434\u0430\u043b\u0438\u0442\u044c\u0020\u0432\u043b\u043e\u0436\u0435\u043d\u0438\u0435',
    'chat.add_file': '\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c\u0020\u0444\u0430\u0439\u043b',
    'chat.choose_file': '\u0412\u044b\u0431\u0440\u0430\u0442\u044c\u0020\u0444\u0430\u0439\u043b',
    'chat.choose_audio': '\u0412\u044b\u0431\u0440\u0430\u0442\u044c\u0020\u0430\u0443\u0434\u0438\u043e\u0444\u0430\u0439\u043b',
    'chat.take_photo': '\u0421\u0434\u0435\u043b\u0430\u0442\u044c\u0020\u0444\u043e\u0442\u043e',
    'chat.take_video': '\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0020\u0432\u0438\u0434\u0435\u043e',
    'chat.cancel': '\u041e\u0442\u043c\u0435\u043d\u0430',
    'chat.preview_image': '[\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435]',
    'chat.preview_video': '[\u0412\u0438\u0434\u0435\u043e]',
    'chat.preview_audio': '[\u0410\u0443\u0434\u0438\u043e]',
    'chat.preview_file': '[\u0424\u0430\u0439\u043b]',
    'dm.search': 'Начать новый чат (npub...)',
    'dm.no_convos': 'Диалоги не найдены.',
    'dm.start_prompt': 'Начните чат с публичным ключом выше.',
    'community.title': 'Сообщество',
    'community.live': 'Прямой эфир с',
    'community.listening': 'Ожидание событий...',
    'community.no_posts': 'Посты не найдены на подключенных реле.',
    'community.post': 'Опубликовать',
    'community.posting': 'Публикация...',
    'community.cancel': 'Отмена',
    'community.whats_happening': 'Что происходит?',
    'community.failed': 'Не удалось опубликовать сообщение.',
    'community.profile': 'Профиль',
    'community.my_posts': 'Мои посты',
    'community.back': 'Назад',
    'group.tab_public': '\u041f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0435',
    'group.tab_joined': '\u041c\u043e\u0438\u0020\u0433\u0440\u0443\u043f\u043f\u044b',
    'group.no_joined': '\u0412\u044b\u0020\u0435\u0449\u0451\u0020\u043d\u0435\u0020\u0432\u0441\u0442\u0443\u043f\u0438\u043b\u0438\u0020\u043d\u0438\u0020\u0432\u0020\u043e\u0434\u043d\u0443\u0020\u0433\u0440\u0443\u043f\u043f\u0443\u002e',
    'group.channel_id': 'ID \u0433\u0440\u0443\u043f\u043f\u044b:',
    'group.members': '\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438:',
    'group.info': '\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f\u0020\u043e\u0020\u0433\u0440\u0443\u043f\u043f\u0435',
    'group.close': '\u0417\u0430\u043a\u0440\u044b\u0442\u044c',
    'group.name': '\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435',
    'group.about': '\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435',
    'group.share': '\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f',
    'group.link_copied': '\u0421\u0441\u044b\u043b\u043a\u0430\u0020\u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430',
    'group.members_recent': '\u041d\u0435\u0434\u0430\u0432\u043d\u0438\u0435\u0020\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435\u0020\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438\u003a',
    'group.subtitle': 'Каналы и групповые чаты',
    'group.create': 'Создать группу',
    'group.join': 'Войти в группу',
    'group.name_placeholder': 'Название группы',
    'group.about_placeholder': 'Описание (необязательно)',
    'group.join_placeholder': 'Вставьте id канала...',
    'group.invalid_channel': 'Неверный id канала.',
    'group.create_failed': 'Не удалось создать группу.',
    'group.no_channels': 'Группы не найдены на подключенных реле.',
    'group.unknown_time': 'неизвестно',
    'group.unnamed': 'Без названия',
    'group.back': 'Назад',
    'group.loading': 'Загрузка канала...',
    'group.no_messages': 'Сообщения не найдены.',
    'group.be_first': 'Скажите привет первым!',
    'group.placeholder': 'Отправить сообщение в группу...',
    'group.send_failed': 'Не удалось отправить. Проверьте подключение к реле.',
  },
};

interface LanguageContextProps {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const LanguageContext = createContext<LanguageContextProps | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguageState] = useState<Language>('en');

  useEffect(() => {
    const saved = localStorage.getItem('nostr_lang') as Language;
    if (saved && dictionary[saved]) {
      setLanguageState(saved);
    }
  }, []);

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
    localStorage.setItem('nostr_lang', lang);
  };

  const t = (key: string): string => {
    return dictionary[language][key] || key;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};
